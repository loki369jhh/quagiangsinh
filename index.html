<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhiệm Vụ Kiếm Tiền</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
            padding: 50px;
        }
        .task-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            margin: 0 auto;
        }
        .task-header {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        .task-list {
            margin-top: 20px;
        }
        .task-item {
            background-color: #f8f9fa;
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            text-align: left;
            transition: opacity 0.3s ease, text-decoration 0.3s ease;
        }
        .task-title {
            font-size: 18px;
            font-weight: bold;
        }
        .task-description {
            margin-top: 5px;
            font-size: 16px;
            color: #555;
        }
        .task-button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .task-button:hover {
            background-color: #0056b3;
        }
        .reset-button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #dc3545;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .reset-button:hover {
            background-color: #c82333;
        }
        .progress {
            margin-top: 20px;
        }
        .progress-bar {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-bar-inner {
            height: 20px;
            width: 0;
            background-color: #28a745;
            text-align: center;
            line-height: 20px;
            color: white;
        }
        /* CSS for completed tasks */
        .completed {
            opacity: 0.6; /* Make the task faded */
            text-decoration: line-through; /* Strike through the task */
        }
    </style>
</head>
<body>

<div class="task-container">
    <div class="task-header">Nhiệm Vụ Kiếm Tiền Hôm Nay</div>

    <div class="task-list">
        <!-- List of tasks -->
        <div class="task-item" id="task1">
            <div class="task-title">Nhiệm Vụ 1: Xem Video Hướng Dẫn</div>
            <div class="task-description">Xem video hướng dẫn kiếm tiền. Kiếm 100k cho mỗi video xem.</div>
            <button class="task-button" onclick="completeTask(1, 100, 'task1')">Hoàn Thành Nhiệm Vụ</button>
        </div>

        <div class="task-item" id="task2">
            <div class="task-title">Nhiệm Vụ 2: Giới Thiệu Bạn Bè</div>
            <div class="task-description">Giới thiệu bạn bè để tham gia. Kiếm 200k cho mỗi người giới thiệu thành công.</div>
            <button class="task-button" onclick="completeTask(2, 200, 'task2')">Hoàn Thành Nhiệm Vụ</button>
        </div>

        <div class="task-item" id="task3">
            <div class="task-title">Nhiệm Vụ 3: Viết Bình Luận</div>
            <div class="task-description">Viết bình luận về sản phẩm. Kiếm 150k cho mỗi bình luận hợp lệ.</div>
            <button class="task-button" onclick="completeTask(3, 150, 'task3')">Hoàn Thành Nhiệm Vụ</button>
        </div>

        <div class="task-item" id="task4">
            <div class="task-title">Nhiệm Vụ 4: Chia Sẻ Trên Mạng Xã Hội</div>
            <div class="task-description">Chia sẻ thông tin trên mạng xã hội. Kiếm 250k cho mỗi lần chia sẻ thành công.</div>
            <button class="task-button" onclick="completeTask(4, 250, 'task4')">Hoàn Thành Nhiệm Vụ</button>
        </div>
    </div>

    <div class="progress">
        <div class="progress-bar">
            <div class="progress-bar-inner" id="progressBar" style="width: 0%;">0%</div>
        </div>
    </div>

    <div class="task-header">Điểm EXP: <span id="expPoints">0</span></div>
    <div class="task-header">Số Nhiệm Vụ Hoàn Thành: <span id="tasksCompleted">0</span></div>

    <!-- Reset button -->
    <button class="reset-button" onclick="resetData()">Reset Dữ Liệu</button>
</div>

<script>
// Kiểm tra nếu có dữ liệu lưu trữ trong localStorage và khôi phục giá trị
let expPoints = localStorage.getItem("expPoints");
let tasksCompleted = localStorage.getItem("tasksCompleted");
let completedTasks = JSON.parse(localStorage.getItem("completedTasks")) || [];
let lastLoginTime = localStorage.getItem("lastLoginTime");

// Nếu không có dữ liệu lưu trữ, khởi tạo giá trị mặc định
if (expPoints === null) {
    expPoints = 0;
    tasksCompleted = 0;
}

// Kiểm tra nếu đã qua 1 tiếng kể từ lần đăng nhập gần nhất
if (lastLoginTime && (new Date().getTime() - lastLoginTime) > 3600000) {
    alert("Bạn đã đăng nhập quá 1 giờ. Hãy đăng nhập lại.");
    resetData();  // Reset dữ liệu khi thời gian đã qua 1 giờ
}

// Lưu thời gian đăng nhập lần này vào localStorage
localStorage.setItem("lastLoginTime", new Date().getTime());

// Hiển thị dữ liệu lên giao diện
document.getElementById("expPoints").textContent = expPoints;
document.getElementById("tasksCompleted").textContent = tasksCompleted;

// Lặp qua các nhiệm vụ đã hoàn thành và đánh dấu chúng
completedTasks.forEach(function(taskId) {
    document.getElementById(taskId).classList.add("completed");
});

function completeTask(taskId, reward, taskElementId) {
    // Kiểm tra nếu nhiệm vụ đã hoàn thành
    if (completedTasks.includes(taskElementId)) {
        alert("Bạn đã hoàn thành nhiệm vụ này rồi!");
        return;
    }

    // Cập nhật điểm EXP và số nhiệm vụ đã hoàn thành
    expPoints = parseInt(expPoints) + reward;
    tasksCompleted = parseInt(tasksCompleted) + 1;

    // Thêm nhiệm vụ vào danh sách đã hoàn thành
    completedTasks.push(taskElementId);

    // Lưu dữ liệu vào LocalStorage
    localStorage.setItem("expPoints", expPoints);
    localStorage.setItem("tasksCompleted", tasksCompleted);
    localStorage.setItem("completedTasks", JSON.stringify(completedTasks));

    // Cập nhật giao diện
    document.getElementById("expPoints").textContent = expPoints;
    document.getElementById("tasksCompleted").textContent = tasksCompleted;

    // Cập nhật tiến độ
    let progress = (tasksCompleted / 4) * 100; // Giả sử có 4 nhiệm vụ
    document.getElementById("progressBar").style.width = progress + "%";
    document.getElementById("progressBar").textContent = Math.round(progress) + "%";

    // Đánh dấu nhiệm vụ đã hoàn thành
    document.getElementById(taskElementId).classList.add("completed");

    // Thông báo hoàn thành
    alert(`Chúc mừng! Bạn đã hoàn thành nhiệm vụ và kiếm được ${reward}k. Tổng điểm EXP hiện tại: ${expPoints}`);
}

function resetData() {
    // Xóa dữ liệu trong localStorage
    localStorage.removeItem("expPoints");
    localStorage.removeItem("tasksCompleted");
    localStorage.removeItem("completedTasks");
    localStorage.removeItem("lastLoginTime");

    // Khôi phục lại các giá trị ban đầu
    expPoints = 0;
    tasksCompleted = 0;
    completedTasks = [];

    // Cập nhật lại giao diện
    document.getElementById("expPoints").textContent = expPoints;
    document.getElementById("tasksCompleted").textContent = tasksCompleted;

    // Lặp qua các nhiệm vụ và bỏ dấu hoàn thành
    document.querySelectorAll('.task-item').forEach(function(task) {
        task.classList.remove("completed");
    });

    // Cập nhật tiến độ
    document.getElementById("progressBar").style.width = "0%";
    document.getElementById("progressBar").textContent = "0%";

    alert("Dữ liệu đã được reset!");
}
</script>

</body>
</html>
